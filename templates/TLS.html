<!-- TLS.html -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TLS Data</title>

    <style>
    
    h1 {
        font-size: 40px; /* Adjust the font size as needed */
        color: darkblue; /* Set the text color */
        text-align: center; /* Center align the text */
        margin-top: 20px; /* Add some top margin for spacing */
        font-weight: bolder;
    }
        /* Updated CSS styles for the table */
        table {
            width: 100%;
            
            font-size: 12px;
            text-align: center;
            font-family: Arial, Helvetica, sans-serif;
            border-collapse: collapse; /* Collapse borders between cells */
            border: 1px solid black; /* Add border to the table */
        }
        th {
            font-weight: bold;
            background-color: skyblue;
        }
        th, td {
            padding: 8px; /* Add padding to cells */
            border: 1px solid black; /* Add border to cells */
        }

        tbody tr:nth-child(even) {
            background-color: #f2f2f2; /* Set your desired gray color */
        }

        tbody tr:hover {
            background-color: #cccccc; /* Light gray background color on hover */
        }

        .print-button {
            background-color: darkblue; /* Green background */
            border: none;
            color: white;
            padding: 15px 32px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 4px 2px;
            cursor: pointer;
            border-radius: 8px;
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
            margin-bottom: 50px;
        }

        /* On mouse-over, add a darker background color */
        .print-button:hover {
            background-color: #2c3e50; 
        }

        .delete {
            background-color: #e74c3c; /* Red background */
            color: white;
            padding: 8px 16px;
            border: none;
            cursor: pointer;
            border-radius: 4px;

        }

        /* On mouse-over, add a darker background color to the delete button */
        .delete:hover {
            background-color: #c0392b; /* Darker red */
        }

        /* Style editable cells differently */
        td[contenteditable="true"] {
            background-color: lightyellow; /* Change background color of editable cells */
            font-weight: bold; /* Make text bold in editable cells */
            color: darkblue; /* Set text color for editable cells */
            cursor: pointer; /* Show cursor pointer for editable cells */
        }

    </style>
</head>
<body>
    <h1>TLS</h1>

     <a href="/tls_auftrag"><button class="print-button">PRINT TLS</button></a>


     <table border="1" id="tlsTable">
        <thead>
            <tr>
                <th>Delete</th>
                <th>ELCO_Nummer</th>
                <th>Maschine</th>
                <th>Mass</th>
                <th>Produktion_Nummer</th>
                <th>L_cm</th>
                <th>My</th>
                <th>Cm3</th>
                <th>Seitl_Rand</th>
                <th>Qual</th>
                <th>Schutzring</th>
                <th>Text</th>
                <th>Bemerkung</th>
                <th>Datum</th>
            </tr>
        </thead>
        <tbody>
            <!-- Populate table content from TLS.json -->
            {% for item in tls_data %}
                <tr>
                    <td>
                        <form id="deleteForm_{{ item.ELCO_Nummer }}" action="{{ url_for('delete_item_TLS', elco_nummer_delete=item.ELCO_Nummer) }}" method="post">
                            <button class="delete" type="button" onclick="confirmDelete('{{ item.ELCO_Nummer }}')">Delete</button>
                        </form>
                    </td>
                    <td>{{ item.ELCO_Nummer }}</td>
                    <td>{{ item.Maschine }}</td>
                    <td>{{ item.Mass }}</td>
                    <td>{{ item.Produktion_Nummer }}</td>
                    <td>{{ item.L_cm }}</td>
                    <td>{{ item.my }}</td>
                    <td>{{ item.cm3 }}</td>
                    <td contenteditable="true" id="seitl_rand_{{ item.ELCO_Nummer }}" oninput="handleCellChange('{{ item.ELCO_Nummer }}', 'seitl_rand', this.innerText)">{{ item.seitl_rand }}</td>
                    <td contenteditable="true" id="qual_{{ item.ELCO_Nummer }}" oninput="handleCellChange('{{ item.ELCO_Nummer }}', 'qual', this.innerText)">{{ item.qual }}</td>
                    <td contenteditable="true" id="schutzring_{{ item.ELCO_Nummer }}" oninput="handleCellChange('{{ item.ELCO_Nummer }}', 'schutzring', this.innerText)">{{ item.schutzring }}</td>
                    <td contenteditable="true" id="text_{{ item.ELCO_Nummer }}" oninput="handleCellChange('{{ item.ELCO_Nummer }}', 'text', this.innerText)">{{ item.text }}</td>
                    <td contenteditable="true" id="bemerkung_{{ item.ELCO_Nummer }}" oninput="handleCellChange('{{ item.ELCO_Nummer }}', 'bemerkung', this.innerText)">{{ item.bemerkung }}</td>
                    <td contenteditable="true" id="datum_{{ item.ELCO_Nummer }}" oninput="handleCellChange('{{ item.ELCO_Nummer }}', 'datum', this.innerText)">{{ item.datum }}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

    <script>
        function confirmDelete(item_id) {
            if (confirm("Are you sure you want to delete this item?")) {
                document.getElementById("deleteForm_" + item_id).submit();
            }
        }
    </script>

<script>
    // Function to handle changes in editable cells
    function handleCellChange(elcoNum, field, value) {
        // Create a data object to send to the server
        const data = {
            elcoNum: elcoNum,
            field: field,
            value: value
        };

        // Send an AJAX POST request to save the updated value
        fetch('/update_cell', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(data),
        })
        .then(response => response.json())
        .then(data => {
            // Reload cell values from JSON data
            reloadCellValues(data);
        })
        .catch((error) => {
            console.error('Error:', error);
        });
    }

    // Function to reload cell values from JSON data
    function reloadCellValues(data) {
        // Loop through the data and update cell values accordingly
        for (const item of data) {
            const elcoNum = item.ELCO_Nummer;
            document.getElementById(`seitl_rand_${elcoNum}`).innerText = item.seitl_rand;
            document.getElementById(`qual_${elcoNum}`).innerText = item.qual;
            document.getElementById(`schutzring_${elcoNum}`).innerText = item.schutzring;
            document.getElementById(`text_${elcoNum}`).innerText = item.text;
            document.getElementById(`bemerkung_${elcoNum}`).innerText = item.bemerkung;
            document.getElementById(`datum_${elcoNum}`).innerText = item.datum;
        }
    }
</script>

</body>
</html>
