<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Farbmeister App</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">

    <style>
        .action-button {
            width: 250px;
            background-color: darkblue; /* Green */
            border: none;
            color: white;
            padding: 10px 20px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 4px 2px;

            cursor: pointer;
            border-radius: 8px;
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
        }

        /* Button hover effect */
        .action-button:hover {
            background-color: #2c3e50; 
        }

        tbody tr:hover {
            background-color: #cccccc; /* Light gray background color on hover */
        }
    </style>
</head>
<body>
    <h1>Farbmeister</h1>
    
    <a href="/tls_page"><button class="action-button">TLS</button></a>
    <a href="/apex_page"><button class="action-button">APEX</button></a>

    
        <table id="inventoryTable">
            <thead>
                <tr>
                    <th>DELETE</th>
                    <th>Edit</th>
                    <th>Pass</th>
                    <th>Magnet</th>
                    <th>TLS</th>
                    <th>APEX</th>
                    {% for category in inventar_data[0].__dict__.keys() %}
                        <th>{{ category }}</th>
                    {% endfor %}

                </tr>
            </thead>
            <tbody>
                
                {% for item in inventar_data %}
                
                    <tr>
                        <td>
                            <form id="deleteForm_{{ item.ELCO_Nummer }}" action="{{ url_for('delete_item', elco_nummer_delete=item.ELCO_Nummer) }}" method="post">
                                <button class="delete" type="button" onclick="confirmDelete('{{ item.ELCO_Nummer }}')">Delete</button>
                            </form>
                        </td>
                        
                        <td>
                            <form action="{{ url_for('edit_item', elco_nummer_edit=item.ELCO_Nummer) }}" method="GET">
                                <button class="edit" type="submit">Edit</button>
                            </form>
                        </td>
                        <td>
                            <form action="{{ url_for('pass_page') }}" method="post">
                                <input type="hidden" name="elco_nummer_pass" value="{{ item.ELCO_Nummer }}">
                                <button class="pass" type="submit">Pass</button>
                            </form>
                        </td>
                        <td>
                            <form action="{{ url_for('magnet_page') }}" method="post">
                                <input type="hidden" name="elco_nummer_magnet" value="{{ item.ELCO_Nummer }}">
                                <button class="magnet" type="submit">Magnet</button>
                            </form>
                        </td>
                        <td>
                            <form action="{{ url_for('to_tls') }}" method="post">
                                <input type="hidden" name="elco_nummer_tls" value="{{ item.ELCO_Nummer }}">
                                <button class="to-tls" type="submit">To TLS</button>
                            </form>
                        </td>
                        <td>
                            <form action="{{ url_for('to_apex') }}" method="post">
                                <input type="hidden" name="elco_nummer_apex" value="{{ item.ELCO_Nummer }}">
                                <button class="to-apex" type="submit">To APEX</button>
                            </form>
                        </td>
                        {% for value in item.__dict__.values() %}
                            <td>{{ value if value != None else "" }}</td>
                        {% endfor %}

                    </tr>
                {% endfor %}
                <tr>
                    
                    <form id="addItemForm" action="/add_item" method="post">
                        <td colspan="5"><button type="submit" class="add-item-button">Add Item</button></td>
                        <td><input type="text" id="elco_nummer" name="elco_nummer" required placeholder="ELCO Nummer"></td>
                        <td><input type="text" id="maschine" name="maschine" placeholder="Maschine"></td>
                        <td><input type="text" id="mass" name="mass" placeholder="Mass"></td>
                        <td><input type="text" id="produktion_nummer" name="produktion_nummer" placeholder="Produktion Nummer"></td>
                        <td><input type="text" id="l_cm" name="l_cm" placeholder="L cm"></td>
                        <td><input type="text" id="my" name="my" placeholder="My"></td>
                        <td><input type="text" id="cm3" name="cm3" placeholder="cm3"></td>
                        <td><input type="text" id="wo" name="wo" placeholder="Wo"></td>
                        <td><input type="text" id="erneuert" name="erneuert" placeholder="Erneuert"></td>
                        <td><input type="text" id="int_ausgang" name="int_ausgang" placeholder="Int Ausgang"></td>
                        <td><input type="text" id="int_eingang" name="int_eingang" placeholder="Int Eingang"></td>
                        <td><input type="text" id="bemerkung" name="bemerkung" placeholder="Bemerkung"></td>
                        <td><input type="text" id="prod_nr_2" name="prod_nr_2" placeholder="Prod Nr 2"></td>
                        <td><input type="text" id="alte_nummer" name="alte_nummer" placeholder="Alte Nummer"></td>
                        <td><input type="text" id="Cheshire" name="Cheshire" placeholder="Cheshire"></td>
                        <td><input type="text" id="Apex" name="Apex" placeholder="Apex"></td>
                        <td><input type="text" id="Praxair" name="Praxair" placeholder="Praxair"></td>
                        <td><input type="text" id="Ersetzt" name="Ersetzt" placeholder="Ersetzt"></td>
                    
                    </form>
                </tr>

            </tbody>
        </table>
    </form>
    <script>
        function confirmDelete(elco_nummer) {
            if (confirm("Are you sure you want to delete this item?")) {
                document.getElementById("deleteForm_" + elco_nummer).submit();
            }
        }
    </script>

<script>
    document.getElementById("addItemForm").addEventListener("submit", function(event) {
        event.preventDefault(); // Prevent default form submission
        
        var elcoNummer = document.getElementById("elco_nummer").value;
        
        // Send AJAX request to check if ELCO number exists
        var xhr = new XMLHttpRequest();
        xhr.open("POST", "/check_elco_nummer_exists", true);
        xhr.setRequestHeader("Content-Type", "application/json");
        xhr.onreadystatechange = function() {
            if (xhr.readyState === XMLHttpRequest.DONE) {
                if (xhr.status === 200) {
                    var response = JSON.parse(xhr.responseText);
                    if (response.exists) {
                        alert("ELCO number already exists. Please choose a different ELCO number.");
                    } else {
                        // If ELCO number does not exist, submit the form
                        document.getElementById("addItemForm").submit();
                    }
                } else {
                    alert("Error checking ELCO number existence. Please try again.");
                }
            }
        };
        xhr.send(JSON.stringify({ elco_nummer: elcoNummer }));
    });
</script>
    
</body>
</html>
